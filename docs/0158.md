# rid relayâ€“åœ¨å†…éƒ¨ç½‘ç»œä¸Šè·å–åŸŸåç”¨æˆ·åçš„ç®€å•æ–¹æ³•

> åŸæ–‡ï¼š<https://kalilinuxtutorials.com/ridrelay-domain-usernames-network/>

åœ¨å†…éƒ¨ç½‘ç»œä¸Šè·å–åŸŸåç”¨æˆ·åçš„å¿«æ·æ–¹å¼ã€‚RidRelay ç»“åˆäº† SMB ä¸­ç»§æ”»å‡»ã€å¸¸è§çš„åŸºäº lsarpc çš„æŸ¥è¯¢å’Œ RID å¾ªç¯æ¥è·å¾—åŸŸç”¨æˆ·ååˆ—è¡¨ã€‚å®ƒé‡‡å–ä»¥ä¸‹æ­¥éª¤:

*   å¯åŠ¨ SMB æœåŠ¡å™¨å¹¶ç­‰å¾…ä¼ å…¥çš„ SMB è¿æ¥
*   ä¼ å…¥çš„å‡­æ®è¢«ä¸­ç»§åˆ°æŒ‡å®šçš„ç›®æ ‡ï¼Œä»è€Œåˆ›å»ºä¸ä¸­ç»§ç”¨æˆ·çš„ä¸Šä¸‹æ–‡çš„è¿æ¥
*   é€šè¿‡ SMB è¿æ¥åˆ° lsarpc ç®¡é“è¿›è¡ŒæŸ¥è¯¢ï¼Œä»¥è·å¾—åŸŸç”¨æˆ·ååˆ—è¡¨ã€‚è¿™é€šè¿‡å¾ªç¯é«˜è¾¾ 50000 RIDs æ¥å®Œæˆã€‚

**ä¹Ÿå¯ç†è§£ä¸º[Mercureâ€”â€”å®‰å…¨ç»ç†ç”¨æ¥è®­ç»ƒä»–ä»¬çš„åŒäº‹è¿›è¡Œç½‘ç»œé’“é±¼çš„å·¥å…·](https://kalilinuxtutorials.com/mercure-tool-security-managers-phishing/)**

## **RidRelay ä¾èµ–å…³ç³»**

*   Python 2.7(æŠ±æ­‰ï¼Œimpacket å’Œ 3 ä¸å…¼å®¹ğŸ™)
*   impactet v0.9.17 æˆ–æ›´é«˜ç‰ˆæœ¬

## **å®‰è£…**

```
**`pipenv install --two
pipenv shell

# Optional: Run if installing impacket
git submodule update --init --recursive
cd submodules/impacket
python setup.py install
cd ../..`** 
```

## **ç”¨é€”**

é¦–å…ˆï¼Œæ‰¾åˆ°ä¸€ä¸ªç›®æ ‡ä¸»æœºè¿›è¡Œä¸­ç»§ã€‚ç›®æ ‡å¿…é¡»æ˜¯åŸŸçš„æˆå‘˜ï¼Œå¹¶ä¸”å¿…é¡»æœ‰ SMB ç™»å½•ã€‚CrackMapExec å¯ä»¥å¾ˆå¿«ä¸ºæ‚¨è·å–è¿™äº›ä¿¡æ¯ï¼

å¯åŠ¨æŒ‡å‘ç›®æ ‡çš„ RidRelay:

```
**python ridrelay.py -t 10.0.0.50** 
```

è¿ç­¹å­¦

è¿˜å°†ç”¨æˆ·åè¾“å‡ºåˆ°æ–‡ä»¶

```
**python ridrelay.py -t 10.0.0.50 -o path_to_output.txt** 
```

[![https://github.com/Nekmo/dirhunt](img//d861a9096555aeb1980fc054015933d7.png)](https://github.com/skorov/ridrelay)